---
layout:     post
title:      转：HowTo:Fixamissingeth0adapteraftermovingUbuntuServerfromoneboxtoanother.
date:       2014-08-21
tags: [cnblogs]
---
遭遇同样的问题，特记录一下

http://www.serenux.com/2009/11/howto-fix-a-missing-eth0-adapter-after-moving-ubuntu-server-from-one-box-to-another/

# HowTo: Fix a missing eth0 adapter after moving Ubuntu Server from one box to another.

The machine starts up fine, but when you try and hit the network, you cant. Closer inspection using the **ifconfig** command reveals that there is no eth0 adapter configured. Why?

Heres how to fix it.

<img title="More..." src="http://www.serenux.com/wp-includes/js/tinymce/plugins/wordpress/img/trans.gif" alt="" data-lazy-loaded="true" />Ubuntu Server keeps tabs on the MAC address of the configured ethernet adapter. Unlike Ubuntu Desktop, you cant simply change network cards willy nilly  while Ubuntu Server does detect and automatically setup new cards, it wont automatically replace any adapter already configured as eth0 with another one, so you need to tell Ubuntu Server that you no longer need the old adapter.

This problem can also appear if you have a virtual machine such as one from Virtualbox, and you move or copy it from one host to another without ensuring that the MAC address configured for that VMs ethernet adapter is 100% identical to the previous one.

These instructions were done with Ubuntu Server 9.04 Jaunty Jackalope in mind, but should apply to just about any release.
<ol>
1. Since you cant SSH in, you will need to login directly on the Ubuntu Server console as an appropriate user with sudo rights..
<li>Once logged in, type in the following and hit Enter:
<pre>$ sudo nano /etc/udev/rules.d/70-persistent-net.rules</pre>
</li>
<li>You are now presented with the Nano text editor and some info that looks similar to the following:
<pre># This file was automatically generated by the /lib/udev/write_net_rules
# program, run by the persistent-net-generator.rules rules file.
#
# You can modify it, as long as you keep each rule on a single
# line, and change only the value of the NAME= key.

# PCI device 0x8086:0x1004 (e1000)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="0a:03:27:c2:b4:eb", ATTR{type}=="1", KERNEL=="eth*", NAME="eth0"</pre>
</li>
1. Delete the last two lines or simply comment out the SUBSYSTEM line on the end. This is a rule defining what MAC address should be explicitly assigned to eth0. Since you no longer have an ethernet card with the specified MAC address in this machine (its on the old PC, remember), Ubuntu Server effectively ignores your new ethernet adapter because its MAC address does not match the defined rule for eth0..
1. Once youve made your changes, press CTRL + X and then Y and then Enter to save your changes..
<li>Now reboot your box with:
<pre>$ sudo reboot</pre>
</li>
1. Upon reboot, Ubuntu Server will detect the new ethernet adapter in your PC and will automatically write a new rule into the **/etc/udev/rules.d/70-persistent-net.rules** file, thus enabling networking over eth0 for your server..
<li>To verify that the new adapter is working, type in:
<pre>$ ifconfig</pre>
and you should see eth0 now listed with your defined IP address..

</li>
1. Test remote connectivity to the server and if all is well, then pat yourself on the back. Youre done.


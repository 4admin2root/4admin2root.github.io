---
layout:     post
title:      转：远程桌面提示：由于网络错误，连接被中断，请重新连接到远程计算机
date:       2012-08-11
tags: [cnblogs]
---
今天遇到和下面文章中描述一样的问题

先保存，准备测试下

[http://blog.csdn.net/ngdly/article/details/5630970](http://blog.csdn.net/ngdly/article/details/5630970)

有时在登陆3389的时候会出现如下提示：

　　具体的解决办法：

　　

　　有时候是这个错误提示：由于网络错误，连接被中断，请重新连接到远程计算机

　　远程连接我肯定是开启了的，防火墙里面3389端口也是打开的，并且连接其他的服务器就可以连接上，说明我本机没问题，用扫描软件，扫描了一下这个服务器，显示IP和端口都是存在的，说明这个服务器网络也没问题，实在没办法，只有不断的测试，后来在系统日志里面看到很多条系统错误信息。其中：严重错误RDP 协议组件 "DATA ENCRYPTION" 在协议流中发现一个错误并且中断了客户端连接。引起了我的注意。

　　几经周折得知这是因为Certificate子键负责终端服务通信中数据信息的认证和加密，它一旦被损坏，终端服务的协议组件就会检测到错误，中断客户机与终端服务器之间的通信。导致Certificate子键损坏的原因很多，如管理员安装和卸载某些系统软件、对终端服务参数的不合理配置等。这时我们需要重置该键值中的内容，才能修复终端服务。

　　进入注册表编辑器窗口，展开HKEY_LOCAL_MA CHINE/ SYSTEM/CurrentCon trolSet/Services/TermService/ Parame ters，找到名为 Certificate的子键，将它删除，重新启动XP系统或Windows 2000 Server服务器，系统就会重新生成 Certificate子键，这样客户端就能正常连接到终端服务器了。

　　在终端服务器出现无法连接的问题后，我们首先要判断这是不是网络故障引起的，检测远程客户端和XP系统 (Windows 2000 Server服务器)是否能够正常连接到网络;然后就要检查终端服务器的加密级别是否设置过高。排除上述原因后，就有可能是Certificate子键损坏了。此外，HKEY_LOCAL _MACHINE/ SYSTEM/Cur rentControlSet/Services/Term Service/Parameters下的 X509 Certificate和X509 Certificate ID损坏了也有可能导致终端服务出现问题，它们的修复方法与Certificate子键损坏后的修复方法相同。

　　讲开了，另外将其他几种远程连接的错误解决方法也附上，以方便需要的朋友：

　　提示本地计算机客户端访问许可不能升级或更新的解决方法：

　　1、打开被控机的注册表编辑器，定位到HKLM/SOFTWARE/Microsoft/MSLicensing。

　　2、备份MSLicensing键。

　　3、删除MSLicensing键，重启系统。

　　提示客户端无法连接到远程计算机。

　　远程计算机不可到达(ping不通或者被中途的园区网防火墙挡住)，或是被控机防火墙没有开相应的端口，或是根本没有开启服务端。

　　提示远程计算机已结束连接的解决方法：

　　1、打开被控机的注册表编辑器，定位到HKLM/SYSTEM/ControlSet001/Enum/Root/RDPDR，备份该项;右键单击该项，选择权限，为当前登录的用户增添完全控制的权限。

2、新建key文件，将以下内容写入，双击导入注册表后重启计算机即可。

　　Windows Registry Editor Version 5.00

　　[HKEY_LOCAL_MACHINE/SYSTEM/ControlSet001/Enum/Root/RDPDR/0000]

　　"ClassGUID"="{4D36E97D-E325-11CE-BFC1-08002BE10318}"

　　"Class"="System"

　　"HardwareID"=hex(7):52,00,4f,00,4f,00,54,00,5c,00,52,00,44,00,50,00,44,00,52,/ 00,00,00,00,00

　　"Driver"="{4D36E97D-E325-11CE-BFC1-08002BE10318}//0030"

　　"Mfg"="(标准系统设备)"

　　"Service"="rdpdr"

　　"DeviceDesc"="终端服务器设备重定向器"

　　"ConfigFlags"=dword:00000000

　　"Capabilities"=dword:00000000

**　　提示客户端无法连接到远程计算机的解决方法**

　　远程计算机不可到达(ping不通或者被中途的园区网防火墙挡住)，或是被控机防火墙没有开相应的端口，或是根本没有开启服务端。

**　　另外几个杂碎的解决办法：**

　　terminal services 服务未启动，启动此服务即可(在运行里输入services.msc可以打开服务管理器)；

　　系统属性里远程页面里的远程桌面未打勾或没有使用有远程登陆权限的用户；前者，可以直接打上勾即可;后者，则需要在选择远程用户...里添加相关账号即可；

　　termsrv.dll文件可能损坏，可以从其它相同系统的system32目录下拷贝一个后，进安全模式(正常模式无法覆盖，除非此服务未启动)，再把此文件覆盖；

　　如果服务启动了，用户也设好了，文件也覆盖过了，几种方法都试过了，还是不行，那么你恐怕只有重装系统了。

---
layout:     post
title:      转：ubuntu12.04下devstack搭建openstack-havana
date:       2014-08-27
tags: [cnblogs]
---
说明：测试devstack，参考了其proxy设置

http://blog.csdn.net/ustc_dylan/article/details/17582783

转：ubuntu 12.04下devstack搭建openstack-havana

整理了下自己在ubuntu 12.04下采用devstack搭建openstack-havana过程的笔记，与大家分享，主要是让大家少踩一些坑！

1. service q-agt is not running!  

1. #vim /etc/enviroment  
1. export http_proxy=http://proxy.com:port  
1. export https_proxy=http://proxy.com:port  
1. export no_proxy=127.0.0.1,localhost  

1. export PIP_CONFIG_FILE=/home/dylan/.pip/pip.conf  

1. #vim ~/.pip/pip.conf  
1. [global]  
1. index-url=http://e.pypi.python.org/simple  
1. [install]  
1. use-mirrors=true  
1. index-url=http://pypi.douban.com  

1. handle Recoverable error: marker cloud not be found (HTTP 400)  

1. vim /opt/stack/horizon/openstack_dashboard/dashboards/admin/metering/views.py  
1.   
1. 第149行，删除参数"marker=tenant_marker"后，重启web服务即可！  

   2. devstack搭建openstack-havana
<ol class="dp-py" start="1">
1. # Misc  
1. DATABASE_PASSWORD=123456  
1. ADMIN_PASSWORD=123456  
1. SERVICE_PASSWORD=123456  
1. SERVICE_TOKEN=123456  
1. RABBIT_PASSWORD=123456  
1.   
1. # Reclone each time  
1. #RECLONE=true  
1.   
1. # Python enviroments  
1. #OFFLINE=true  
1.   
1. ## For Keystone  
1. KEYSTONE_TOKEN_FORMAT=PKI  
1.   
1. ## For Swift  
1. SWIFT_REPLICAS=1  
1. SWIFT_HASH=011688b44136573e209e  
1.   
1. # Enable Logging  
1. LOGFILE=/opt/stack/logs/stack.sh.log  
1. VERBOSE=True  
1. LOG_COLOR=True  
1. SCREEN_LOGDIR=/opt/stack/logs  
1.   
1. # Pre-requisite  
1. ENABLED_SERVICES=rabbit,mysql,key  
1.   
1. ## If you want ZeroMQ instead of RabbitMQ (don't forget to un-declare 'rabbit' from the pre-requesite)  
1. ENABLED_SERVICES+=,-rabbit,-qpid,zeromq  
1.   
1. ## If you want Qpid instead of RabbitMQ (don't forget to un-declare 'rabbit' from the pre-requesite)  
1. #ENABLED_SERVICES+=,-rabbit,-zeromq,qpid  
1.   
1. # Horizon (Dashboard UI) - (always use the trunk)  
1. ENABLED_SERVICES+=,horizon  
1. HORIZON_REPO=https://github.com/openstack/horizon  
1. HORIZON_BRANCH=master  
1.   
1. # Nova - Compute Service  
1. ENABLED_SERVICES+=,n-api,n-crt,n-obj,n-cpu,n-cond,n-sch  
1. IMAGE_URLS+=",https://launchpad.net/cirros/trunk/0.3.0/+download/cirros-0.3.0-x86_64-disk.img"  
1.   
1. ## Nova Cells  
1. ENABLED_SERVICES+=,n-cell  
1.   
1. # Glance - Image Service  
1. ENABLED_SERVICES+=,g-api,g-reg  
1.   
1. # Swift - Object Storage  
1. ENABLED_SERVICES+=,s-proxy,s-object,s-container,s-account  
1.   
1. # Neutron - Networking Service  
1. # If Neutron is not declared the old good nova-network will be used  
1. ENABLED_SERVICES+=,q-svc,q-agt,q-dhcp,q-l3,q-meta,neutron  
1.   
1. ## Neutron - Load Balancing  
1. ENABLED_SERVICES+=,q-lbaas  
1.   
1. ## Neutron - VPN as a Service  
1. ENABLED_SERVICES+=,q-vpn  
1.   
1. ## Neutron - Firewall as a Service  
1. ENABLED_SERVICES+=,q-fwaas  
1.   
1. # VLAN configuration  
1. Q_PLUGIN=ml2  
1. ENABLE_TENANT_VLANS=True  
1.   
1. # GRE tunnel configuration  
1. Q_PLUGIN=ml2  
1. ENABLE_TENANT_TUNNELS=True  
1.   
1. # VXLAN tunnel configuration  
1. Q_PLUGIN=ml2  
1. Q_ML2_TENANT_NETWORK_TYPE=vxlan     
1.   
1. # Cinder - Block Device Service  
1. ENABLED_SERVICES+=,cinder,c-api,c-vol,c-sch  
1.   
1. # Heat - Orchestration Service  
1. ENABLED_SERVICES+=,heat,h-api,h-api-cfn,h-api-cw,h-eng  
1. IMAGE_URLS+=",http://fedorapeople.org/groups/heat/prebuilt-jeos-images/F17-x86_64-cfntools.qcow2"  
1.   
1. # Ceilometer - Metering Service (metering + alarming)  
1. CEILOMETER_BACKEND=mysql  
1. ENABLED_SERVICES+=,ceilometer-acompute,ceilometer-acentral,ceilometer-collector,ceilometer-api  
1. ENABLED_SERVICES+=,ceilometer-alarm-notify,ceilometer-alarm-eval  
1.   
1. # Apache fronted for WSGI  
1. APACHE_ENABLED_SERVICES+=keystone,swift  
1. 

